
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å–µå–µå•è¯ç‹ V12.0 - ç»ˆæä¿®å¤ç‰ˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/canvas-confetti@1.6.0/dist/confetti.browser.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@700;900&display=swap');
        
        body { font-family: 'Noto Sans SC', sans-serif; background: #f0f2f5; height: 100vh; overflow: hidden; }
        
        .app-container { height: 100vh; display: flex; flex-direction: column; padding: 1.5rem; }

        /* å¡ç‰‡é«˜çº§æ ·å¼ï¼šä¿®å¤äº†ä¹‹å‰çš„è¯­æ³•é”™è¯¯ */
        .card {
            flex: 1; margin: 0.6rem; background: rgba(255, 255, 255, 0.95); border-radius: 1.8rem;
            border: 4px solid white; transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            display: flex; flex-direction: column; align-items: center; justify-content: center; 
            box-shadow: 0 8px 15px rgba(0,0,0,0.08); cursor: pointer; position: relative;
            font-size: 2rem; font-weight: 900; color: #1e293b;
        }

        .card-active { transform: scale(1.05) translateY(-5px); border-color: #3b82f6; box-shadow: 0 15px 30px rgba(59,130,246,0.3); z-index: 10; }

        .card-matched { transform: scale(0) rotate(180deg); opacity: 0; pointer-events: none; }

        .shake { animation: shake 0.4s both; border-color: #f87171 !important; background: #fef2f2 !important; }
        @keyframes shake { 0%,100%{transform:rotate(0)} 25%{transform:rotate(-4deg)} 75%{transform:rotate(4deg)} }

        /* å…¥åœºåŠ¨ç”» */
        .card-init { transform: scale(0.5) translateY(100px); opacity: 0; }
        
        /* æŠ¥å‘Šå•è£…é¥° */
        .star-item { transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
    </style>
</head>
<body>

    <div id="homeUI" class="fixed inset-0 z-[100] bg-white flex flex-col items-center justify-center p-8 text-center">
        <div class="text-[120px] mb-6 animate-bounce">ğŸ†</div>
        <h1 class="text-6xl font-black text-slate-800 mb-4 tracking-tight">å–µå–µå•è¯ç‹ <span class="text-blue-500">V12</span></h1>
        <p class="text-slate-400 text-xl font-bold mb-12">ä¿®å¤é”™è¯¯ï¼Œæé€Ÿè¿›åŒ–</p>
        <button id="startBtn" class="bg-blue-600 text-white px-20 py-8 rounded-[2.5rem] text-4xl font-black shadow-2xl active:scale-95 transition-all">
            å¼€å§‹é—¯å…³
        </button>
    </div>

    <div class="app-container">
        <header class="flex justify-between items-center mb-6">
            <button onclick="location.reload()" class="w-14 h-14 bg-white rounded-2xl shadow-sm flex items-center justify-center text-2xl">ğŸ </button>
            <div id="lvName" class="bg-white/90 px-8 py-3 rounded-2xl shadow-sm text-2xl font-black text-slate-700">åŠ è½½ä¸­</div>
            <div class="text-3xl font-black text-blue-600 bg-white px-6 py-3 rounded-2xl shadow-sm" id="score">0</div>
        </header>

        <div class="w-full h-3 bg-white/50 rounded-full mb-8 overflow-hidden">
            <div id="progress" class="h-full bg-blue-500 transition-all duration-500" style="width: 0%"></div>
        </div>

        <main class="flex-1 flex gap-4 min-h-0">
            <div id="leftCol" class="flex-1 flex flex-col"></div>
            <div id="rightCol" class="flex-1 flex flex-col"></div>
        </main>
    </div>

    <div id="reportModal" class="hidden fixed inset-0 z-[110] bg-slate-900/90 backdrop-blur-xl flex items-center justify-center p-6">
        <div class="bg-white w-full max-w-lg rounded-[3.5rem] p-10 shadow-2xl text-center">
            <div id="stars" class="text-7xl mb-6 flex justify-center gap-2"></div>
            <h2 class="text-4xl font-black text-slate-800 mb-2">æœ¬å…³æˆç»©å•</h2>
            <p id="timeSpend" class="text-slate-400 font-bold mb-8 italic"></p>
            
            <div id="reportList" class="max-h-[35vh] overflow-y-auto mb-10 space-y-2 px-2 text-left"></div>

            <button id="nextBtn" class="w-full bg-blue-600 text-white py-7 rounded-3xl text-3xl font-black active:scale-95 shadow-xl">
                ä¸‹ä¸€å…³ ğŸ¾
            </button>
        </div>
    </div>

    <script>
        let audioCtx, curLv=0, score=0, matched=0, selL=null, selR=null, errorCount=0, startTime;
        let attemptLog = {};

        const LIB = [
            { name: "ğŸ æ°´æœç¯‡", words: [{id:1,en:'Apple',cn:'è‹¹æœ',icon:'ğŸ'},{id:2,en:'Banana',cn:'é¦™è•‰',icon:'ğŸŒ'},{id:3,en:'Grape',cn:'è‘¡è„',icon:'ğŸ‡'},{id:4,en:'Peach',cn:'æ¡ƒå­',icon:'ğŸ‘'}] },
            { name: "ğŸ¦ åŠ¨ç‰©ç¯‡", words: [{id:5,en:'Lion',cn:'ç‹®å­',icon:'ğŸ¦'},{id:6,en:'Panda',cn:'ç†ŠçŒ«',icon:'ğŸ¼'},{id:7,en:'Rabbit',cn:'å…”å­',icon:'ğŸ°'},{id:8,en:'Tiger',cn:'è€è™',icon:'ğŸ¯'}] },
            { name: "ğŸ¥› æ—©é¤ç¯‡", words: [{id:9,en:'Bread',cn:'é¢åŒ…',icon:'ğŸ'},{id:10,en:'Milk',cn:'ç‰›å¥¶',icon:'ğŸ¥›'},{id:11,en:'Egg',cn:'é¸¡è›‹',icon:'ğŸ¥š'},{id:12,en:'Cake',cn:'è›‹ç³•',icon:'ğŸ°'}] }
        ];

        function playSfx(correct) {
            if(!audioCtx) return;
            const o = audioCtx.createOscillator(), g = audioCtx.createGain();
            o.connect(g); g.connect(audioCtx.destination);
            const t = audioCtx.currentTime;
            if(correct) {
                o.frequency.setValueAtTime(523.25, t); o.frequency.exponentialRampToValueAtTime(1046.5, t+0.2);
                g.gain.setValueAtTime(0.1, t); g.gain.linearRampToValueAtTime(0, t+0.3);
            } else {
                o.type='sawtooth'; o.frequency.setValueAtTime(200, t); o.frequency.linearRampToValueAtTime(100, t+0.2);
                g.gain.setValueAtTime(0.05, t); g.gain.linearRampToValueAtTime(0, t+0.2);
            }
            o.start(); o.stop(t+0.3);
        }

        function speak(t) { new Audio(`https://dict.youdao.com/dictvoice?audio=${encodeURIComponent(t)}&type=2`).play(); }

        document.getElementById('startBtn').onclick = () => {
            audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            initLevel(0);
        };

        function initLevel(idx) {
            curLv=idx; matched=0; selL=null; selR=null; errorCount=0; startTime = Date.now();
            attemptLog = {};
            LIB[curLv].words.forEach(w => attemptLog[w.id] = { ...w, ok: true });
            
            document.getElementById('homeUI').classList.add('hidden');
            document.getElementById('reportModal').classList.add('hidden');
            document.getElementById('lvName').innerText = LIB[curLv].name;
            updateUI();
            render();
        }

        function updateUI() {
            document.getElementById('score').innerText = score;
            document.getElementById('progress').style.width = (matched / LIB[curLv].words.length * 100) + '%';
        }

        function render() {
            const l = document.getElementById('leftCol'), r = document.getElementById('rightCol');
            l.innerHTML = ''; r.innerHTML = '';
            const w = LIB[curLv].words;
            [...w].sort(()=>Math.random()-0.5).forEach((item, i) => l.appendChild(createCard(item.en, 'L', item.id, item.en, i)));
            [...w].sort(()=>Math.random()-0.5).forEach((item, i) => r.appendChild(createCard(item.icon + ' ' + item.cn, 'R', item.id, item.en, i)));
        }

        function createCard(txt, side, id, eng, delay) {
            const c = document.createElement('div');
            c.className = "card card-init";
            c.innerText = txt;
            setTimeout(() => c.classList.remove('card-init'), delay * 100);
            
            c.onclick = (e) => {
                if(c.classList.contains('card-matched')) return;
                speak(eng);
                if(side==='L'){ if(selL) selL.classList.remove('card-active'); selL=c; }
                else { if(selR) selR.classList.remove('card-active'); selR=c; }
                c.classList.add('card-active');

                if(selL && selR) {
                    if(selL.dataset.id === selR.dataset.id) {
                        score += 100; matched++; playSfx(true);
                        confetti({ particleCount: 40, spread: 70, origin: { x: e.clientX/window.innerWidth, y: e.clientY/window.innerHeight } });
                        const a=selL, b=selR;
                        setTimeout(() => { a.classList.add('card-matched'); b.classList.add('card-matched'); }, 150);
                        selL=null; selR=null;
                        if(matched === LIB[curLv].words.length) setTimeout(showReport, 800);
                    } else {
                        errorCount++; attemptLog[selL.dataset.id].ok = false;
                        playSfx(false);
                        const a=selL, b=selR;
                        a.classList.add('shake'); b.classList.add('shake');
                        setTimeout(() => { a.classList.remove('card-active','shake'); b.classList.remove('card-active','shake'); }, 400);
                        selL=null; selR=null;
                    }
                    updateUI();
                }
            };
            c.dataset.id = id;
            return c;
        }

        function showReport() {
            const modal = document.getElementById('reportModal');
            const list = document.getElementById('reportList');
            const starBox = document.getElementById('stars');
            list.innerHTML = ''; starBox.innerHTML = '';
            
            const dur = Math.floor((Date.now() - startTime) / 1000);
            document.getElementById('timeSpend').innerText = `è€—æ—¶: ${dur}ç§’`;

            let starCount = errorCount === 0 ? 3 : (errorCount < 3 ? 2 : 1);
            for(let i=0; i<3; i++) {
                const s = document.createElement('span');
                s.innerText = 'â­';
                s.className = `star-item ${i < starCount ? 'opacity-100 scale-110' : 'opacity-20'}`;
                starBox.appendChild(s);
            }

            Object.values(attemptLog).forEach(w => {
                const item = document.createElement('div');
                item.className = `flex justify-between p-4 rounded-2xl ${w.ok ? 'bg-green-50' : 'bg-red-50 border-2 border-red-200'}`;
                item.innerHTML = `<div><p class="font-black">${w.en}</p><p class="text-xs opacity-60">${w.cn}</p></div><span>${w.ok?'âœ…':'âŒ'}</span>`;
                list.appendChild(item);
            });

            modal.classList.remove('hidden');
            document.getElementById('nextBtn').onclick = () => {
                if(curLv < LIB.length - 1) initLevel(curLv+1);
                else { alert("æ­å–œé€šå…³ï¼"); location.reload(); }
            };
        }
    </script>
</body>
</html>
