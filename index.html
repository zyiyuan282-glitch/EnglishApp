
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å–µå–µå•è¯ç‹ - ç»ˆææœ‰å£°ç‰ˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/canvas-confetti@1.6.0/dist/confetti.browser.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@700;900&display=swap');
        
        body { 
            font-family: 'Noto Sans SC', sans-serif; 
            background: #f0f9ff; 
            user-select: none; 
            -webkit-tap-highlight-color: transparent;
            overflow-x: hidden;
        }

        /* å¡ç‰‡ç«‹ä½“æ•ˆæœ */
        .card-item {
            font-size: 1.5rem;
            font-weight: 900;
            transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border-bottom: 6px solid #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 80px;
        }

        .card-selected {
            transform: translateY(-6px);
            background-color: #3b82f6 !important;
            color: white !important;
            border-bottom-color: #1d4ed8;
            box-shadow: 0 12px 20px -5px rgba(59, 130, 246, 0.4);
        }

        .matched-hide {
            animation: matchOut 0.5s forwards;
            pointer-events: none;
        }

        @keyframes matchOut {
            0% { transform: scale(1) rotate(0); opacity: 1; }
            50% { transform: scale(1.2) rotate(10deg); opacity: 0.5; }
            100% { transform: scale(0); opacity: 0; }
        }

        .pet-float { animation: float 3s ease-in-out infinite; }
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <div id="homeUI" class="fixed inset-0 z-[100] bg-white flex flex-col items-center justify-center p-8 text-center">
        <div class="text-[140px] pet-float mb-6">ğŸ±</div>
        <h1 class="text-4xl font-black text-slate-800 mb-2">å–µå–µå•è¯ç‹</h1>
        <p class="text-blue-500 font-bold mb-12 text-lg">å¤§å£°è·Ÿè¯»ï¼Œè½»æ¾é—¯å…³ï¼</p>
        <button onclick="initGame(0)" class="w-full max-w-xs bg-blue-600 text-white text-2xl font-bold py-6 rounded-[2.5rem] shadow-2xl shadow-blue-200 active:scale-95 transition-all">
            å¼€å§‹å­¦ä¹ ä¹‹æ—… ğŸš€
        </button>
    </div>

    <header class="p-4 flex justify-between items-center bg-white/90 backdrop-blur-md shadow-sm sticky top-0 z-10">
        <div class="flex items-center gap-3">
            <button onclick="location.reload()" class="w-10 h-10 bg-slate-100 rounded-full flex items-center justify-center text-xl">ğŸ </button>
            <div>
                <div id="levelTitle" class="text-lg font-black text-slate-700 leading-none">çƒ­å¸¦æ°´æœ</div>
                <div class="text-[10px] text-blue-400 font-bold uppercase mt-1">Practice Mode</div>
            </div>
        </div>
        <div class="bg-blue-50 px-4 py-1 rounded-full border border-blue-100">
            <span id="score" class="text-2xl font-black text-blue-600">0</span>
        </div>
    </header>

    <main class="flex-grow p-4 max-w-lg mx-auto w-full">
        <div class="w-full h-3 bg-slate-200 rounded-full mb-8 overflow-hidden">
            <div id="progressBar" class="h-full bg-blue-500 transition-all duration-500" style="width: 0%"></div>
        </div>

        <div class="grid grid-cols-2 gap-4" id="board">
            <div id="leftCol" class="space-y-4"></div>
            <div id="rightCol" class="space-y-4"></div>
        </div>
    </main>

    <footer class="p-6 flex justify-center items-center">
        <div id="petAvatar" class="text-7xl pet-float opacity-50">ğŸ±</div>
    </footer>

    <div id="winModal" class="hidden fixed inset-0 z-[110] bg-slate-900/70 backdrop-blur-sm flex items-center justify-center p-6 text-center">
        <div class="bg-white w-full max-w-sm rounded-[3.5rem] p-10 shadow-2xl border-4 border-white">
            <div class="text-8xl mb-6">ğŸ†</div>
            <h2 class="text-3xl font-black text-slate-800 mb-2">å¤ªæ£’äº†ï¼</h2>
            <p class="text-slate-400 mb-10">ä½ å·²ç»æŒæ¡äº†æœ¬å…³æ‰€æœ‰å•è¯</p>
            <button id="nextBtn" class="w-full bg-blue-600 text-white font-black py-5 rounded-2xl text-xl shadow-lg active:scale-95">
                æŒ‘æˆ˜ä¸‹ä¸€å…³
            </button>
        </div>
    </div>

    <script>
        // --- æ ¸å¿ƒåŠŸèƒ½ 1ï¼šè¯­éŸ³å’ŒéŸ³æ•ˆ ---
        function speak(text) {
            // è¿‡æ»¤æ‰è¡¨æƒ…ç¬¦å·åªæœ—è¯»è‹±æ–‡å†…å®¹
            const pureText = text.replace(/[^\x00-\xff]/g, "").trim();
            const msg = new SpeechSynthesisUtterance();
            msg.text = pureText;
            msg.lang = 'en-US'; 
            msg.rate = 0.85; // è¯­é€Ÿé€‚ä¸­
            window.speechSynthesis.speak(msg);
        }

        function playDing() {
            const ctx = new (window.AudioContext || window.webkitAudioContext)();
            const osc = ctx.createOscillator();
            const gain = ctx.createGain();
            osc.connect(gain);
            gain.connect(ctx.destination);
            osc.frequency.setValueAtTime(880, ctx.currentTime);
            gain.gain.setValueAtTime(0.1, ctx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.5);
            osc.start();
            osc.stop(ctx.currentTime + 0.5);
        }

        // --- æ ¸å¿ƒåŠŸèƒ½ 2ï¼šè¯åº“ç®¡ç† ---
        const LIB = [
            { 
                title: "ç¬¬ä¸€å…³ï¼šçƒ­å¸¦æ°´æœ", 
                words: [
                    { id: 1, en: 'Apple', cn: 'è‹¹æœ', icon: 'ğŸ' },
                    { id: 2, en: 'Banana', cn: 'é¦™è•‰', icon: 'ğŸŒ' },
                    { id: 3, en: 'Grape', cn: 'è‘¡è„', icon: 'ğŸ‡' },
                    { id: 4, en: 'Peach', cn: 'æ¡ƒå­', icon: 'ğŸ‘' }
                ]
            },
            { 
                title: "ç¬¬äºŒå…³ï¼šæ£®æ—åŠ¨ç‰©", 
                words: [
                    { id: 5, en: 'Lion', cn: 'ç‹®å­', icon: 'ğŸ¦' },
                    { id: 6, en: 'Panda', cn: 'ç†ŠçŒ«', icon: 'ğŸ¼' },
                    { id: 7, en: 'Rabbit', cn: 'å…”å­', icon: 'ğŸ°' },
                    { id: 8, en: 'Tiger', cn: 'è€è™', icon: 'ğŸ¯' }
                ]
            }
        ];

        let curLv = 0, selL = null, selR = null, matched = 0, score = 0;

        // --- æ ¸å¿ƒåŠŸèƒ½ 3ï¼šæ¸¸æˆé€»è¾‘ ---
        function initGame(idx) {
            curLv = idx; matched = 0; selL = null; selR = null;
            document.getElementById('homeUI').classList.add('hidden');
            document.getElementById('winModal').classList.add('hidden');
            document.getElementById('levelTitle').innerText = LIB[curLv].title;
            document.getElementById('progressBar').style.width = '0%';
            render();
        }

        function render() {
            const lCol = document.getElementById('leftCol'), rCol = document.getElementById('rightCol');
            lCol.innerHTML = ''; rCol.innerHTML = '';
            const words = LIB[curLv].words;
            // éšæœºæ´—ç‰Œ
            const dL = [...words].sort(() => Math.random() - 0.5);
            const dR = [...words].sort(() => Math.random() - 0.5);

            dL.forEach(i => lCol.appendChild(createBtn(i.en, 'L', i.id, i.en)));
            dR.forEach(i => rCol.appendChild(createBtn(i.icon + ' ' + i.cn, 'R', i.id, i.en)));
        }

        function createBtn(txt, side, id, english) {
            const b = document.createElement('button');
            b.className = "card-item w-full bg-white rounded-[2rem] text-slate-700 shadow-sm";
            b.innerText = txt;
            b.onclick = () => {
                speak(english); // ç‚¹å‡»æœ—è¯»
                
                if (side === 'L') {
                    if(selL) selL.classList.remove('card-selected');
                    selL = b;
                } else {
                    if(selR) selR.classList.remove('card-selected');
                    selR = b;
                }
                b.classList.add('card-selected');

                if (selL && selR) {
                    if (selL.dataset.id === selR.dataset.id) {
                        score += 100; matched++;
                        document.getElementById('score').innerText = score;
                        document.getElementById('progressBar').style.width = (matched / LIB[curLv].words.length * 100) + '%';
                        
                        playDing(); // æˆåŠŸéŸ³æ•ˆ
                        confetti({ particleCount: 40, spread: 60, origin: { y: 0.8 } });

                        const l = selL, r = selR;
                        l.classList.add('matched-hide'); r.classList.add('matched-hide');
                        selL = null; selR = null;

                        if (matched === LIB[curLv].words.length) setTimeout(showVictory, 800);
                    } else {
                        const l = selL, r = selR;
                        l.classList.add('bg-red-50', 'border-red-200');
                        r.classList.add('bg-red-50', 'border-red-200');
                        setTimeout(() => {
                            l.classList.remove('card-selected', 'bg-red-50', 'border-red-200');
                            r.classList.remove('card-selected', 'bg-red-50', 'border-red-200');
                        }, 400);
                        selL = null; selR = null;
                    }
                }
            };
            b.dataset.id = id;
            return b;
        }

        function showVictory() {
            document.getElementById('winModal').classList.remove('hidden');
            const nextBtn = document.getElementById('nextBtn');
            if (curLv < LIB.length - 1) {
                nextBtn.innerText = "æŒ‘æˆ˜ä¸‹ä¸€å…³";
                nextBtn.onclick = () => initGame(curLv + 1);
            } else {
                nextBtn.innerText = "é‡æ–°å¼€å§‹å­¦ä¹ ";
                nextBtn.onclick = () => location.reload();
            }
        }
    </script>
</body>
</html>
