
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å–µå–µå•è¯ç‹ - å…»æˆç³»ä¹å­¦</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/canvas-confetti@1.6.0/dist/confetti.browser.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@700;900&display=swap');
        body { font-family: 'Noto Sans SC', sans-serif; background: #f8fafc; user-select: none; -webkit-tap-highlight-color: transparent; }
        
        /* æ ¸å¿ƒå¡ç‰‡æ ·å¼ï¼šå¤§ã€é‡ã€ç¨³ */
        .card-item {
            font-size: 1.5rem;
            font-weight: 900;
            transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border-bottom: 5px solid #e2e8f0;
        }
        .card-selected {
            transform: translateY(-5px);
            background-color: #3b82f6 !important;
            color: white !important;
            border-bottom-color: #1d4ed8;
            box-shadow: 0 10px 20px -5px rgba(59, 130, 246, 0.5);
        }
        .card-error {
            animation: shake 0.4s ease-in-out;
            background-color: #fee2e2 !important;
            border-bottom-color: #f87171;
        }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-8px); } 75% { transform: translateX(8px); } }
        
        /* æ¶ˆé™¤åŠ¨ç”» */
        .matched-hide { animation: zoomOut 0.4s forwards; pointer-events: none; }
        @keyframes zoomOut { 0% { transform: scale(1); opacity: 1; } 100% { transform: scale(0); opacity: 0; } }

        /* å…»æˆåé¦ˆï¼šçŒ«å’ªæµ®åŠ¨ */
        .pet-float { animation: petFloat 3s ease-in-out infinite; }
        @keyframes petFloat { 0%, 100% { transform: translateY(0) rotate(0); } 50% { transform: translateY(-12px) rotate(5deg); } }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <div id="homeUI" class="fixed inset-0 z-[100] bg-white flex flex-col items-center justify-center p-8">
        <div class="text-[120px] pet-float mb-4">ğŸ±</div>
        <h1 class="text-4xl font-black text-slate-800 mb-2">å–µå–µå•è¯ç‹</h1>
        <p class="text-blue-500 font-bold tracking-widest mb-12">å…»æˆ Â· æ¢é™© Â· è®°å•è¯</p>
        <div class="w-full max-w-xs space-y-4">
            <button onclick="initGame(0)" class="w-full bg-blue-600 text-white text-2xl font-bold py-6 rounded-[2rem] shadow-xl active:scale-95 transition-all">å¼€å§‹æ¢é™©</button>
            <div class="text-center text-slate-300 text-sm">å½“å‰è¿›åº¦ï¼šæ£®æ—åœ°å›¾ 5%</div>
        </div>
    </div>

    <header class="p-4 flex justify-between items-center bg-white/80 backdrop-blur-md sticky top-0 z-10 border-b border-slate-100">
        <div class="flex items-center gap-3">
            <div class="w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center text-xl">ğŸ—ºï¸</div>
            <div>
                <div id="levelTag" class="text-xs font-black text-blue-400 uppercase tracking-tighter">Level 1</div>
                <div id="levelTitle" class="text-base font-bold text-slate-700 leading-none">çƒ­å¸¦æ°´æœ</div>
            </div>
        </div>
        <div class="flex flex-col items-end">
            <span id="score" class="text-2xl font-black text-blue-600 leading-none">0</span>
            <span class="text-[10px] font-bold text-slate-300 tracking-widest uppercase">Points</span>
        </div>
    </header>

    <main class="flex-grow p-4 max-w-lg mx-auto w-full">
        <div class="w-full h-3 bg-slate-100 rounded-full mb-6 overflow-hidden border border-slate-50">
            <div id="progressBar" class="h-full bg-gradient-to-r from-blue-400 to-blue-600 transition-all duration-500" style="width: 0%"></div>
        </div>

        <div class="grid grid-cols-2 gap-4" id="board">
            <div id="leftCol" class="space-y-4"></div>
            <div id="rightCol" class="space-y-4"></div>
        </div>
    </main>

    <nav class="p-6 bg-white border-t border-slate-100 flex justify-around items-end relative">
        <div class="text-center">
            <div class="text-2xl mb-1">ğŸ¯</div>
            <div class="text-[10px] font-black text-slate-400 uppercase">Energy</div>
        </div>

        <div class="relative -top-10">
            <div id="petAvatar" class="text-7xl pet-float filter drop-shadow-xl cursor-pointer">ğŸ¾</div>
            <div id="popBubble" class="absolute -top-12 -right-8 bg-blue-600 text-white text-xs px-3 py-1 rounded-full opacity-0 transition-all font-bold">Awesome!</div>
        </div>

        <div class="text-center">
            <div id="timerDisplay" class="text-xl font-black text-slate-700">15:00</div>
            <div class="text-[10px] font-black text-slate-400 uppercase">Rest</div>
        </div>
    </nav>

    <div id="winModal" class="hidden fixed inset-0 z-[110] bg-slate-900/60 backdrop-blur-md flex items-center justify-center p-6 text-center">
        <div class="bg-white w-full max-w-sm rounded-[3rem] p-8 shadow-2xl border-4 border-white">
            <div class="text-7xl mb-4">ğŸ†</div>
            <h2 class="text-2xl font-black text-slate-800">ä»Šæ—¥å­¦ä¹ æˆ˜æŠ¥</h2>
            <div class="my-6 space-y-3">
                <div class="bg-blue-50 p-4 rounded-2xl flex justify-between items-center border border-blue-100">
                    <span class="font-bold text-blue-700 italic font-mono">âœ… Mastered</span>
                    <span id="statOk" class="text-2xl font-black text-blue-600">0</span>
                </div>
                <div class="bg-orange-50 p-4 rounded-2xl flex justify-between items-center border border-orange-100">
                    <span class="font-bold text-orange-700 italic font-mono">âš ï¸ Review</span>
                    <span id="statReview" class="text-2xl font-black text-orange-600">0</span>
                </div>
            </div>
            <button id="nextBtn" class="w-full bg-blue-600 text-white font-black py-5 rounded-2xl text-xl shadow-lg active:scale-95 transition-all">æŒ‘æˆ˜ä¸‹ä¸€å…³</button>
        </div>
    </div>

    <script>
        // --- ğŸ§± æ¶æ„å±‚ 1ï¼šç¦»çº¿åº“ (Layer 1: Offline Database) ---
        const LIB = [
            { title: "æ°´æœæ´¾å¯¹", tag: "Level 1", words: [
                { id: 1, en: 'Apple', cn: 'è‹¹æœ', icon: 'ğŸ' },
                { id: 2, en: 'Banana', cn: 'é¦™è•‰', icon: 'ğŸŒ' },
                { id: 3, en: 'Grape', cn: 'è‘¡è„', icon: 'ğŸ‡' },
                { id: 4, en: 'Peach', cn: 'æ¡ƒå­', icon: 'ğŸ‘' }
            ]},
            { title: "æ£®æ—åŠ¨ç‰©", tag: "Level 2", words: [
                { id: 5, en: 'Lion', cn: 'ç‹®å­', icon: 'ğŸ¦' },
                { id: 6, en: 'Panda', cn: 'ç†ŠçŒ«', icon: 'ğŸ¼' },
                { id: 7, en: 'Rabbit', cn: 'å…”å­', icon: 'ğŸ°' },
                { id: 8, en: 'Tiger', cn: 'è€è™', icon: 'ğŸ¯' }
            ]}
        ];

        // --- ğŸ§± æ¶æ„å±‚ 2ï¼šçŠ¶æ€æœº (Layer 2: State Machine) ---
        let curLv = 0;
        let selL = null, selR = null, matched = 0, score = 0;
        let errors = new Set();

        function initGame(lvIdx) {
            curLv = lvIdx; matched = 0; selL = null; selR = null; errors.clear();
            document.getElementById('homeUI').classList.add('hidden');
            document.getElementById('winModal').classList.add('hidden');
            document.getElementById('levelTag').innerText = LIB[curLv].tag;
            document.getElementById('levelTitle').innerText = LIB[curLv].title;
            renderBoard();
        }

        function renderBoard() {
            const lCol = document.getElementById('leftCol');
            const rCol = document.getElementById('rightCol');
            lCol.innerHTML = ''; rCol.innerHTML = '';
            
            const words = LIB[curLv].words;
            const dataL = [...words].sort(() => Math.random() - 0.5);
            const dataR = [...words].sort(() => Math.random() - 0.5);

            dataL.forEach(i => lCol.appendChild(makeBtn(i.en, 'L', i.id)));
            dataR.forEach(i => rCol.appendChild(makeBtn(i.icon+' '+i.cn, 'R', i.id)));
        }

        function makeBtn(txt, side, id) {
            const b = document.createElement('button');
            b.className = "card-item w-full py-6 bg-white rounded-3xl text-slate-700 active:scale-95";
            b.innerText = txt;
            b.onclick = () => {
                if (side === 'L') {
                    if(selL) selL.classList.remove('card-selected');
                    selL = b;
                } else {
                    if(selR) selR.classList.remove('card-selected');
                    selR = b;
                }
                b.classList.add('card-selected');

                if (selL && selR) {
                    if (selL.dataset.id === id || (side === 'L' ? selR.dataset.id == id : selL.dataset.id == id)) {
                        // åŒ¹é…æˆåŠŸé€»è¾‘
                        if (selL.dataset.id === selR.dataset.id) {
                            handleMatch(selL, selR);
                        } else {
                            handleError(selL, selR);
                        }
                    }
                }
            };
            b.dataset.id = id;
            return b;
        }

        function handleMatch(l, r) {
            score += 100; matched++;
            document.getElementById('score').innerText = score;
            document.getElementById('progressBar').style.width = (matched / LIB[curLv].words.length * 100) + '%';
            
            // çˆ½æ„Ÿåé¦ˆ
            confetti({ particleCount: 30, spread: 60, origin: { y: 0.8 }, colors:['#3b82f6','#60a5fa'] });
            showBubble();
            updatePet(matched / LIB[curLv].words.length);

            l.classList.add('matched-hide'); r.classList.add('matched-hide');
            selL = null; selR = null;

            if (matched === LIB[curLv].words.length) setTimeout(showVictory, 600);
        }

        function handleError(l, r) {
            errors.add(LIB[curLv].words.find(w => w.id == l.dataset.id).en);
            l.classList.add('card-error'); r.classList.add('card-error');
            setTimeout(() => {
                l.classList.remove('card-selected', 'card-error');
                r.classList.remove('card-selected', 'card-error');
                selL = null; selR = null;
            }, 500);
        }

        // --- ğŸ§± æ¶æ„å±‚ 3ï¼šåé¦ˆä¸ UI å¢å¼º ---
        function showBubble() {
            const b = document.getElementById('popBubble');
            b.classList.replace('opacity-0', 'opacity-100');
            setTimeout(() => b.classList.replace('opacity-100', 'opacity-0'), 1000);
        }

        function updatePet(p) {
            const avatar = document.getElementById('petAvatar');
            if (p >= 1) avatar.innerText = 'ğŸ‘‘';
            else if (p >= 0.5) avatar.innerText = 'ğŸ“';
            else avatar.innerText = 'ğŸ±';
        }

        function showVictory() {
            document.getElementById('winModal').classList.remove('hidden');
            document.getElementById('statOk').innerText = LIB[curLv].words.length - errors.size;
            document.getElementById('statReview').innerText = errors.size;
            
            const nextBtn = document.getElementById('nextBtn');
            if (curLv < LIB.length - 1) {
                nextBtn.innerText = "æŒ‘æˆ˜ä¸‹ä¸€å…³";
                nextBtn.onclick = () => initGame(curLv + 1);
            } else {
                nextBtn.innerText = "å®Œæˆä»Šæ—¥ä»»åŠ¡ï¼";
                nextBtn.onclick = () => location.reload();
            }
        }
    </script>
</body>
</html>
