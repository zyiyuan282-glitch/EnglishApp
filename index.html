
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å–µå–µå•è¯ç‹ - é«˜æ¸…æœ‰å£°ç‰ˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/canvas-confetti@1.6.0/dist/confetti.browser.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@900&display=swap');
        body { font-family: 'Noto Sans SC', sans-serif; background: #f0f9ff; user-select: none; -webkit-tap-highlight-color: transparent; }
        
        /* å¡ç‰‡è®¾è®¡ */
        .card-item {
            font-size: 2.5rem;
            font-weight: 900;
            transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border-bottom: 8px solid #cbd5e1;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 140px;
            background: white;
            border-radius: 2.5rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        .card-selected {
            transform: translateY(-10px);
            background-color: #3b82f6 !important;
            color: white !important;
            border-bottom-color: #1d4ed8;
            box-shadow: 0 20px 25px -5px rgba(59, 130, 246, 0.4);
        }

        .matched-hide { animation: matchOut 0.5s forwards; pointer-events: none; }
        @keyframes matchOut { 0% { transform: scale(1); opacity: 1; } 100% { transform: scale(0); opacity: 0; } }
        
        /* æ¼‚æµ®åŠ¨ç”» */
        .floating { animation: float 3s ease-in-out infinite; }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-20px); } }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <div id="homeUI" class="fixed inset-0 z-[100] bg-white flex flex-col items-center justify-center p-8 text-center">
        <div class="relative w-64 h-64 mb-10">
            <div class="absolute inset-0 bg-blue-100 rounded-full scale-110"></div>
            <img src="https://api.dicebear.com/7.x/bottts/svg?seed=Felix" class="hidden"> <div class="text-[120px] floating">ğŸ“ğŸ±</div> 
        </div>
        <h1 class="text-6xl font-black text-slate-800 mb-4">å–µå–µå•è¯ç‹</h1>
        <p class="text-blue-500 font-bold mb-16 text-2xl px-4">åä¸ºå¹³æ¿å·²é€‚é…ï¼šç‚¹å‡»å¼€å§‹å¬å‘éŸ³</p>
        <button id="startBtn" class="w-full max-w-lg bg-orange-500 text-white text-4xl font-black py-10 rounded-[4rem] shadow-2xl active:scale-95 transition-all">
            ç‚¹æˆ‘å¼€å§‹ ğŸš€
        </button>
    </div>

    <header class="p-8 flex justify-between items-center bg-white shadow-sm sticky top-0 z-10">
        <button onclick="location.reload()" class="w-20 h-20 bg-slate-100 rounded-full flex items-center justify-center text-5xl">ğŸ </button>
        <div id="levelTitle" class="text-4xl font-black text-slate-700">ç¬¬ä¸€å…³</div>
        <div class="bg-blue-50 px-10 py-4 rounded-full border-4 border-white shadow-sm">
            <span id="score" class="text-5xl font-black text-blue-600">0</span>
        </div>
    </header>

    <main class="flex-grow p-8 max-w-7xl mx-auto w-full">
        <div class="w-full h-8 bg-slate-200 rounded-full mb-16 overflow-hidden shadow-inner">
            <div id="progressBar" class="h-full bg-blue-500 rounded-full transition-all duration-500" style="width: 0%"></div>
        </div>
        
        <div class="grid grid-cols-2 gap-10" id="board">
            <div id="leftCol" class="space-y-10"></div>
            <div id="rightCol" class="space-y-10"></div>
        </div>
    </main>

    <script>
        let audioCtx = null;

        // æ ¸å¿ƒï¼šç‚¹å‡»æŒ‰é’®åæ¿€æ´»éŸ³é¢‘ç¯å¢ƒ
        function initAudio() {
            audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            if (audioCtx.state === 'suspended') audioCtx.resume();
        }

        // å¼ºåŠ›äº‘ç«¯å‘éŸ³ï¼šç»•è¿‡å¹³æ¿ç³»ç»Ÿè¯­éŸ³åŒ…ç¼ºå¤±çš„é—®é¢˜
        function speak(text) {
            const pureText = text.replace(/[^\x00-\xff]/g, "").trim();
            // ç›´æ¥è¯·æ±‚æœ‰é“äº‘ç«¯ç¾éŸ³ MP3
            const audio = new Audio(`https://dict.youdao.com/dictvoice?audio=${encodeURIComponent(pureText)}&type=2`);
            audio.play().catch(e => {
                console.log("äº‘ç«¯åŠ è½½å¤±è´¥ï¼Œå°è¯•ç³»ç»Ÿå…œåº•");
                const msg = new SpeechSynthesisUtterance(pureText);
                msg.lang = 'en-US';
                window.speechSynthesis.speak(msg);
            });
        }

        // å®çš„ä¸€å£°
        function playDing() {
            if (!audioCtx) return;
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain); gain.connect(audioCtx.destination);
            osc.frequency.setValueAtTime(880, audioCtx.currentTime);
            gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.4);
            osc.start(); osc.stop(audioCtx.currentTime + 0.4);
        }

        const LIB = [
            { title: "ğŸ æ°´æœæ’æ’ç«™", words: [{ id: 1, en: 'Apple', cn: 'è‹¹æœ', icon: 'ğŸ' },{ id: 2, en: 'Banana', cn: 'é¦™è•‰', icon: 'ğŸŒ' },{ id: 3, en: 'Grape', cn: 'è‘¡è„', icon: 'ğŸ‡' },{ id: 4, en: 'Peach', cn: 'æ¡ƒå­', icon: 'ğŸ‘' }]},
            { title: "ğŸ¦ åŠ¨ç‰©å¯¹å¯¹ç¢°", words: [{ id: 5, en: 'Lion', cn: 'ç‹®å­', icon: 'ğŸ¦' },{ id: 6, en: 'Panda', cn: 'ç†ŠçŒ«', icon: 'ğŸ¼' },{ id: 7, en: 'Rabbit', cn: 'å…”å­', icon: 'ğŸ°' },{ id: 8, en: 'Tiger', cn: 'è€è™', icon: 'ğŸ¯' }]}
        ];

        let curLv = 0, selL = null, selR = null, matched = 0, score = 0;

        document.getElementById('startBtn').onclick = () => {
            initAudio();
            initGame(0);
        };

        function initGame(idx) {
            curLv = idx; matched = 0;
            document.getElementById('homeUI').classList.add('hidden');
            document.getElementById('levelTitle').innerText = LIB[curLv].title;
            render();
        }

        function render() {
            const lCol = document.getElementById('leftCol'), rCol = document.getElementById('rightCol');
            lCol.innerHTML = ''; rCol.innerHTML = '';
            const words = LIB[curLv].words;
            const dL = [...words].sort(() => Math.random() - 0.5);
            const dR = [...words].sort(() => Math.random() - 0.5);
            dL.forEach(i => lCol.appendChild(createBtn(i.en, 'L', i.id, i.en)));
            dR.forEach(i => rCol.appendChild(createBtn(i.icon + ' ' + i.cn, 'R', i.id, i.en)));
        }

        function createBtn(txt, side, id, english) {
            const b = document.createElement('button');
            b.className = "card-item w-full";
            b.innerText = txt;
            b.onclick = () => {
                speak(english);
                if (side === 'L') { if(selL) selL.classList.remove('card-selected'); selL = b; }
                else { if(selR) selR.classList.remove('card-selected'); selR = b; }
                b.classList.add('card-selected');
                
                if (selL && selR) {
                    if (selL.dataset.id === selR.dataset.id) {
                        score += 100; matched++;
                        document.getElementById('score').innerText = score;
                        document.getElementById('progressBar').style.width = (matched / LIB[curLv].words.length * 100) + '%';
                        playDing();
                        confetti({ particleCount: 100, spread: 70, origin: { y: 0.8 } });
                        const l = selL, r = selR;
                        l.classList.add('matched-hide'); r.classList.add('matched-hide');
                        selL = null; selR = null;
                        if (matched === LIB[curLv].words.length) {
                             setTimeout(() => {
                                if (curLv < LIB.length - 1) initGame(curLv + 1);
                                else { alert("å¤ªæ£’äº†ï¼å…¨éƒ¨é€šå…³ï¼ğŸ†"); location.reload(); }
                             }, 1000);
                        }
                    } else {
                        const l = selL, r = selR;
                        setTimeout(() => { l.classList.remove('card-selected'); r.classList.remove('card-selected'); }, 400);
                        selL = null; selR = null;
                    }
                }
            };
            b.dataset.id = id;
            return b;
        }
    </script>
</body>
</html>
