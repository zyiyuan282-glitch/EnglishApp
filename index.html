
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å–µå–µå•è¯ç‹ V13.0 - ç¡¬æ ¸è¿›åŒ–ç‰ˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/canvas-confetti@1.6.0/dist/confetti.browser.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@700;900&display=swap');
        body { font-family: 'Noto Sans SC', sans-serif; background: #F1F5F9; height: 100vh; overflow: hidden; }
        
        .card {
            flex: 1; margin: 0.5rem; background: white; border-radius: 1.5rem;
            border: 4px solid #E2E8F0; transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            display: flex; align-items: center; justify-content: center; text-align: center;
            box-shadow: 0 8px 0 #E2E8F0; cursor: pointer; font-size: 1.8rem; font-weight: 900;
        }

        /* é€‰ä¸­ä¸åŒ¹é…åŠ¨ç”» */
        .card-active { transform: translateY(4px); border-color: #3B82F6; box-shadow: 0 2px 0 #3B82F6; background: #EFF6FF; }
        .card-matched { transform: scale(0); opacity: 0; pointer-events: none; }
        .card-hidden .content { filter: blur(10px); opacity: 0.1; } /* å›°éš¾æ¨¡å¼é®ç½© */

        /* å‡åˆ†çº¢å…‰é—ªçƒ */
        .score-minus { color: #EF4444 !important; animation: scorePop 0.5s ease-out; }
        @keyframes scorePop { 0% { transform: scale(1.5); } 100% { transform: scale(1); } }

        .shake-screen { animation: screenShake 0.3s; }
        @keyframes screenShake { 0%,100% { transform: translateX(0); } 25% { transform: translateX(-8px); } 75% { transform: translateX(8px); } }

        .difficulty-btn { transition: all 0.2s; border: 4px solid transparent; }
        .difficulty-btn.active { border-color: #3B82F6; transform: scale(1.05); }
    </style>
</head>
<body id="mainBody">

    <div id="homeUI" class="fixed inset-0 z-[100] bg-white flex flex-col items-center justify-center p-6 text-center">
        <div class="text-[100px] mb-4">ğŸ“</div>
        <h1 class="text-6xl font-black text-slate-800 mb-2">å–µå–µå•è¯ç‹</h1>
        <p class="text-slate-400 font-bold mb-10 text-xl text-red-500">æ³¨æ„ï¼šç­”é”™ä¼šå®æ—¶æ‰£é™¤åˆ†æ•°ï¼</p>
        
        <div class="flex gap-6 mb-10 w-full max-w-xl">
            <button onclick="setDiff('easy')" id="btn-easy" class="difficulty-btn flex-1 bg-green-100 p-6 rounded-3xl active">
                <div class="text-4xl mb-2">ğŸŒ±</div>
                <div class="font-black text-green-700 text-2xl">ç®€å•</div>
                <div class="text-sm text-green-600">4ç»„/å…¨æ˜¾ç¤º</div>
            </button>
            <button onclick="setDiff('hard')" id="btn-hard" class="difficulty-btn flex-1 bg-red-100 p-6 rounded-3xl">
                <div class="text-4xl mb-2">ğŸ”¥</div>
                <div class="font-black text-red-700 text-2xl">å›°éš¾</div>
                <div class="text-sm text-red-600">6ç»„/è®°å¿†é®ç½©</div>
            </button>
        </div>

        <button id="startBtn" class="bg-blue-600 text-white px-24 py-8 rounded-[2.5rem] text-4xl font-black shadow-2xl active:scale-95 transition-all">
            å¼€å§‹æŒ‘æˆ˜
        </button>
    </div>

    <div class="h-screen flex flex-col p-4">
        <header class="flex justify-between items-center mb-4">
            <button onclick="location.reload()" class="w-14 h-14 bg-white rounded-2xl shadow flex items-center justify-center text-2xl">ğŸ </button>
            <div id="scoreBox" class="text-5xl font-black text-blue-600 transition-all duration-300">0</div>
            <div id="combo" class="w-14 h-14 bg-orange-400 text-white rounded-full flex items-center justify-center font-black text-xl shadow-lg scale-0 transition-transform">x2</div>
        </header>

        <div class="w-full h-3 bg-slate-200 rounded-full mb-6">
            <div id="progress" class="h-full bg-green-500 transition-all duration-300" style="width: 0%"></div>
        </div>

        <main class="flex-1 flex gap-4 min-h-0">
            <div id="leftCol" class="flex-1 flex flex-col"></div>
            <div id="rightCol" class="flex-1 flex flex-col"></div>
        </main>
    </div>

    <div id="reportModal" class="hidden fixed inset-0 z-[110] bg-slate-900/90 backdrop-blur-xl flex items-center justify-center p-4">
        <div class="bg-white w-full max-w-md rounded-[3rem] p-10 text-center shadow-2xl">
            <div id="stars" class="text-7xl mb-6">â­â­â­</div>
            <h2 class="text-4xl font-black text-slate-800 mb-6">å­¦ä¹ æ€»ç»“</h2>
            <div class="space-y-4 mb-10 text-xl font-bold text-slate-600" id="reportStats"></div>
            <button id="nextBtn" class="w-full bg-blue-600 text-white py-7 rounded-2xl text-3xl font-black active:scale-95">ä¸‹ä¸€å…³ ğŸš€</button>
        </div>
    </div>

    <script>
        let audioCtx, curLv=0, score=0, matched=0, selL=null, selR=null, errorCount=0, combo=0, diff='easy';
        const LIB = [
            { name: "ğŸ æ°´æœ", words: [{id:1,en:'Apple',cn:'è‹¹æœ',icon:'ğŸ'},{id:2,en:'Banana',cn:'é¦™è•‰',icon:'ğŸŒ'},{id:3,en:'Grape',cn:'è‘¡è„',icon:'ğŸ‡'},{id:4,en:'Peach',cn:'æ¡ƒå­',icon:'ğŸ‘'},{id:5,en:'Pear',cn:'æ¢¨å­',icon:'ğŸ'},{id:6,en:'Melon',cn:'ç“œ',icon:'ğŸ‰'}] },
            { name: "ğŸ¯ åŠ¨ç‰©", words: [{id:7,en:'Lion',cn:'ç‹®å­',icon:'ğŸ¦'},{id:8,en:'Panda',cn:'ç†ŠçŒ«',icon:'ğŸ¼'},{id:9,en:'Rabbit',cn:'å…”å­',icon:'ğŸ°'},{id:10,en:'Tiger',cn:'è€è™',icon:'ğŸ¯'},{id:11,en:'Bear',cn:'ç†Š',icon:'ğŸ»'},{id:12,en:'Wolf',cn:'ç‹¼',icon:'ğŸº'}] }
        ];

        function setDiff(d) {
            diff = d;
            document.querySelectorAll('.difficulty-btn').forEach(b => b.classList.remove('active'));
            document.getElementById('btn-'+d).classList.add('active');
        }

        function playSfx(type) {
            if(!audioCtx) return;
            const o = audioCtx.createOscillator(), g = audioCtx.createGain();
            o.connect(g); g.connect(audioCtx.destination);
            const t = audioCtx.currentTime;
            if(type === 'win') { o.frequency.setValueAtTime(523, t); o.frequency.exponentialRampToValueAtTime(1046, t+0.1); }
            else { o.type='sawtooth'; o.frequency.setValueAtTime(200, t); o.frequency.linearRampToValueAtTime(50, t+0.2); }
            g.gain.setValueAtTime(0.1, t); g.gain.linearRampToValueAtTime(0, t+0.2);
            o.start(); o.stop(t+0.2);
        }

        function speak(t) { new Audio(`https://dict.youdao.com/dictvoice?audio=${encodeURIComponent(t)}&type=2`).play(); }

        document.getElementById('startBtn').onclick = () => {
            audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            initLevel(0);
        };

        function initLevel(idx) {
            curLv=idx; matched=0; selL=null; selR=null; errorCount=0; combo=0;
            document.getElementById('homeUI').classList.add('hidden');
            document.getElementById('reportModal').classList.add('hidden');
            render();
            updateUI();
        }

        function updateUI() {
            const sBox = document.getElementById('scoreBox');
            sBox.innerText = score;
            const wordsInLv = diff === 'easy' ? 4 : 6;
            document.getElementById('progress').style.width = (matched / wordsInLv * 100) + '%';
            document.getElementById('combo').style.transform = combo > 1 ? 'scale(1)' : 'scale(0)';
            document.getElementById('combo').innerText = 'x' + combo;
        }

        function render() {
            const l = document.getElementById('leftCol'), r = document.getElementById('rightCol');
            l.innerHTML = ''; r.innerHTML = '';
            const wordsInLv = diff === 'easy' ? 4 : 6;
            const pool = LIB[curLv].words.slice(0, wordsInLv);
            
            [...pool].sort(()=>Math.random()-0.5).forEach(w => l.appendChild(createCard(w.en, 'L', w.id, w.en)));
            [...pool].sort(()=>Math.random()-0.5).forEach(w => r.appendChild(createCard(w.icon + ' ' + w.cn, 'R', w.id, w.en)));

            if(diff === 'hard') {
                setTimeout(() => {
                    document.querySelectorAll('.card').forEach(c => c.classList.add('card-hidden'));
                }, 2000);
            }
        }

        function createCard(txt, side, id, eng) {
            const c = document.createElement('div');
            c.className = "card";
            c.innerHTML = `<span class="content">${txt}</span>`;
            c.onclick = (e) => {
                if(c.classList.contains('card-matched')) return;
                c.classList.remove('card-hidden');
                speak(eng);
                if(side==='L'){ if(selL) selL.classList.remove('card-active'); selL=c; }
                else { if(selR) selR.classList.remove('card-active'); selR=c; }
                c.classList.add('card-active');

                if(selL && selR) {
                    if(selL.dataset.id === selR.dataset.id) {
                        combo++; score += (100 * combo); matched++;
                        playSfx('win');
                        confetti({ particleCount: 30, spread: 60, origin: { x: e.clientX/window.innerWidth, y: e.clientY/window.innerHeight } });
                        const a=selL, b=selR;
                        setTimeout(() => { a.classList.add('card-matched'); b.classList.add('card-matched'); }, 200);
                        selL=null; selR=null;
                        if(matched === (diff==='easy'?4:6)) setTimeout(showReport, 800);
                    } else {
                        // æƒ©ç½šå‡åˆ†é€»è¾‘
                        combo = 0; errorCount++;
                        score = Math.max(0, score - 50); 
                        document.getElementById('scoreBox').classList.add('score-minus');
                        document.getElementById('mainBody').classList.add('shake-screen');
                        playSfx('lose');
                        const a=selL, b=selR;
                        setTimeout(() => {
                            a.classList.remove('card-active','score-minus');
                            b.classList.remove('card-active','score-minus');
                            document.getElementById('mainBody').classList.remove('shake-screen');
                            if(diff==='hard') { a.classList.add('card-hidden'); b.classList.add('card-hidden'); }
                        }, 400);
                        selL=null; selR=null;
                    }
                    updateUI();
                }
            };
            c.dataset.id = id;
            return c;
        }

        function showReport() {
            const modal = document.getElementById('reportModal');
            document.getElementById('stars').innerText = errorCount === 0 ? "â­â­â­" : (errorCount < 3 ? "â­â­" : "â­");
            document.getElementById('reportStats').innerHTML = `
                <div class="flex justify-between"><span>å¾—åˆ†:</span><span class="text-blue-600">${score}</span></div>
                <div class="flex justify-between"><span>é”™è¯¯æ¬¡æ•°:</span><span class="text-red-500">${errorCount}</span></div>
                <div class="text-sm opacity-50">éš¾åº¦: ${diff === 'easy' ? 'ç®€å•' : 'æŒ‘æˆ˜'}</div>
            `;
            modal.classList.remove('hidden');
            document.getElementById('nextBtn').onclick = () => {
                if(curLv < LIB.length - 1) initLevel(curLv+1);
                else { alert("ğŸ‰ å…¨èƒ½é€šå…³ï¼ä½ æ˜¯å•è¯ç‹ï¼"); location.reload(); }
            };
        }
    </script>
</body>
</html>
